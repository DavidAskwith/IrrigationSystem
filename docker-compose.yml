version: '3'
services:
    ui:
        container_name: irigation-system-ui
        build: ./ui
        command: sh -c 'npm run serve'
        volumes: 
            - './ui:/app'
            - '/app/node_modules'
        ports:
            - '8080:8080'
        working_dir: /app
    api:
        container_name: irigation-system-api
        build: ./api
        command: sh -c 'dotnet watch run --no-restore'
        environment:
            # enables watch
            - DOTNET_USE_POLLING_FILE_WATCHER=1
            # set to 0.0.0.0 because you can't acces via localhost in container
            - ASPNETCORE_URLS=https://0.0.0.0:5000
        volumes:
            - './api:/app'
        ports:
            - '5000:5000'
        working_dir: /app
